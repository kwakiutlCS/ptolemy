


<section class="name_getter">
  <p>Inserir nome, <%= session[:name] %></p>
  <%= form_tag("/static_pages/set_name", remote:true, method: "get") do %>
  <%= text_field_tag(:name, nil, id:"student_name_field") %>
  <%= submit_tag(:ok, id:"student_name_submit") %>
  <% end %>
</section>


<section class="background">
<h1>O aquecimento da piscina</h1>

<p>Qual a energia necessária para aquecer a água de uma piscina da temperatura ambiente (cerca de 15ºC neste momento) até 24ºC?</p>

</section>



<section class="strategy">
  <h2>Estratégia</h2>
  <div>
  Responder a esta questão poderá ser feito tendo a piscina, e aquecendo a água até aos 22ºC. Assim poderíamos, por exemplo, controlar os gastos energéticos pela fatura da eletricidade. Claro que para isto teríamos de ter a piscina! Seria melhor se pudessemos estimar os gastos de eletricidade sem termos de instalá-la.
  </div>
  
  <div>
  Os cientistas usam um processo em que testam o problema em pequena escala e tentam descobrir padrões que lhes permitem tirar conclusões sobre o caso maior. Chamam a isto construir um modelo.
  </div>

  <div>
    Neste caso, isto pode ser feito com um calorímetro

  </div>
   
</section>



<section class="">
  
<script type="text/paperscript" canvas="canvas">
	  

var calor = new Raster("calorimeter");
calor.position = view.center;



var water = new Path();

water.closed = true;

water.fillColor = new Color(0,0,1,0.3);

water.add(new Point(77,461));
water.add(new Point(90,469));
water.add(new Point(120,473));
water.add(new Point(160,475));
water.add(new Point(300,475));
water.add(new Point(337,469));
water.add(new Point(350,461));

water.add(new Point(350,461));
water.add(new Point(337,458));
water.add(new Point(300,455));
water.add(new Point(160,455));
water.add(new Point(120,457));
water.add(new Point(90,458));
water.add(new Point(77,461));

var height = 0;
var time = 0;
var temperature = 15.0;
var mass = 0;
var animate = false;
var base = 0.5;
var y_scale = 0.005555556;
var rho = 1;
var P = 500;
var c_water = 4180;
var dt;
var Q;

var top = new Path.Ellipse(new Rectangle(77,453,273,22));
top.fillColor = new Color(0,0,1,0.3);
water.visible = false;
top.visible = false;
var speed = 2;

function onKeyDown(evt) {
    if (evt.key == "up" && height < 270) {
	 if (height == 0) {
	     water.visible = true;
	     top.visible = true;
	 }
	 else {
	     for (var k in water.segments) {
		  if (k >= 7)
		      water.segments[k].point.y -= speed;
	     }
	     top.bounds.y -= speed;
	     
	 }
	 height += speed;
    }
    if (evt.key == "down" && height > 0) {
	 if (height == speed) {
	     water.visible = false;
	     top.visible = false;
	 }
	 else {
	     for (var k in water.segments) {
		  if (k >= 7)
		      water.segments[k].point.y += speed;
	     }
	     top.bounds.y += speed;
	 }
	 height -= speed;
    }
    $("#volume").html((base*height*y_scale*1000).toFixed(1)+" cm<sup>3</sup>");

}


function onFrame(evt) {
    
    dt = evt.delta;

    if (animate) {
	 time += dt;
	 $("#chrono").text(time.toFixed(1)+ " s");
	 	 
	 Q = P * dt;
	 
	 mass = getMass(base, height*y_scale, rho);
	 
        temperature += (Q/(mass*c_water)*(1.3-(Math.random()*0.6)));
	 
	 $("#thermo").text(temperature.toFixed(1)+ " ºC");
	 if (temperature > 60) {
	     reset();
	 }
    }
}

$(document).ready(function() {
    
    $("#onoff").on("click", function() {
	 mass = getMass(base, height*y_scale, rho);
	 if (mass > 0.135) {
	     if ($(this).text() == "Iniciar") {
		  $(this).text("Parar");
		  animate = true;
	     }
	     else {
		  $(this).text("Iniciar");
		  animate = false;
	     }
	 }
	 else 
	     alert(mass);
    });

    $("#restart").on("click", function() {
	 reset();
	 
    });

});


function getMass(base, h, rho) {
    return base*h*rho;
}

function reset() {
    temperature = 15.0;
	 mass = 0;
	 time = 0;
	 animate = false;
	 $("#onoff").text("Iniciar");
	 $("#chrono").text("0 s");
	 $("#thermo").text("15.0 ºC");
	 $("#volume").html("0.0 cm<sup>3</sup>");   
	 top.bounds.y += height;
	 top.visible = false;
	 for (var k in water.segments) {
	     if (k >= 7)
		  water.segments[k].point.y += height;
	 }
	 water.visible = false;
	 height = 0;
}


	</script>
        
        

    <canvas id="canvas" width=400 height=500></canvas>
   
    <img src="assets/calorimeter.png" class="paper_img" id="calorimeter"></img>
    <div id="chrono">0 s</div>
    <div id="thermo">15.0 ºC</div>
    <div id="volume">0.0 cm<sup>3</sup></div>
    
    
    <div class="btn-group">
    <button type="button" class="btn btn-default" id="onoff">Iniciar</button>
    <button type="button" class="btn btn-default" id="restart">Reiniciar</button>
    </div>



</section>


<section class="model-choice">
  

</section>


<section class="questions">


</section>
